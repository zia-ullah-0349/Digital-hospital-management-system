#include <iostream>
#include <vector>
#include <string>
#include <fstream>

using namespace std;

[span_0](start_span)// Structure for Patient records[span_0](end_span)
struct Patient {
    int id;
    string name;
    string medicalHistory;
};

[span_1](start_span)// Structure for Appointment Scheduling[span_1](end_span)
struct Appointment {
    int patientId;
    string date;
    string time;
};

[span_2](start_span)// Structure for Billing[span_2](end_span)
struct Bill {
    int patientId;
    double amount;
    string status; // PAID or UNPAID
};

[span_3](start_span)[span_4](start_span)// Global Vectors for data storage[span_3](end_span)[span_4](end_span)
vector<Patient> patients;
vector<Appointment> appointments;
vector<Bill> bills;

[span_5](start_span)// Function Prototypes[span_5](end_span)
void loadAllData();
void saveAllData();
void addPatient();
void scheduleAppointment();
void processBilling();
bool login();

int main() {
    loadAllData(); [span_6](start_span)// System Initialization[span_6](end_span)

    cout << "--- Digital Hospital Management System ---" << endl;
    
    [span_7](start_span)[span_8](start_span)// User Authentication[span_7](end_span)[span_8](end_span)
    if (!login()) {
        cout << "Authentication failed. Exiting system." << endl;
        return 0;
    }

    int choice;
    while (true) {
        cout << "\n--- Administration Panel ---" << endl;
        cout << "1. Add Patient\n2. Schedule Appointment\n3. Process Billing\n4. Exit" << endl;
        cout << "Select Task: ";
        cin >> choice;

        switch (choice) {
            case 1: addPatient(); break;
            case 2: scheduleAppointment(); break;
            case 3: processBilling(); break;
            case 4: 
                saveAllData(); [span_9](start_span)// Data Persistence on Exit[span_9](end_span)
                cout << "Data saved. Goodbye!" << endl;
                return 0;
            default: cout << "Invalid choice." << endl;
        }
    }
}

[span_10](start_span)[span_11](start_span)// Authentication Logic[span_10](end_span)[span_11](end_span)
bool login() {
    string username, password;
    cout << "Username: "; cin >> username;
    cout << "Password: "; cin >> password;
    // Simple check for demonstration purposes
    return (username == "admin" && password == "1234");
}

void addPatient() {
    Patient p;
    cout << "Enter Patient ID: "; cin >> p.id;
    cin.ignore();
    cout << "Enter Patient Name: "; getline(cin, p.name);
    cout << "Enter Medical History: "; getline(cin, p.medicalHistory);
    
    patients.push_back(p);
    saveAllData(); [span_12](start_span)// Immediate save[span_12](end_span)
    cout << "Patient registered successfully!" << endl;
}

void scheduleAppointment() {
    Appointment app;
    cout << "Enter Patient ID for Appointment: "; cin >> app.patientId;
    cout << "Enter Date (DD/MM/YYYY): "; cin >> app.date;
    cout << "Enter Time: "; cin >> app.time;
    
    appointments.push_back(app);
    saveAllData();
    cout << "Appointment scheduled!" << endl;
}

void processBilling() {
    Bill b;
    cout << "Enter Patient ID for bill: "; cin >> b.patientId;
    cout << "Enter Amount: "; cin >> b.amount;
    b.status = "UNPAID"; [span_13](start_span)// Initial status[span_13](end_span)
    
    bills.push_back(b);
    saveAllData();
    cout << "Bill generated successfully!" << endl;
}

[span_14](start_span)[span_15](start_span)// File I/O for persistence[span_14](end_span)[span_15](end_span)
void saveAllData() {
    ofstream pFile("patients.txt");
    for (const auto& p : patients) {
        pFile << p.id << "," << p.name << "," << p.medicalHistory << endl;
    }
    pFile.close();

    ofstream aFile("appointments.txt");
    for (const auto& a : appointments) {
        aFile << a.patientId << "," << a.date << "," << a.time << endl;
    }
    aFile.close();
}

void loadAllData() {
    // Logic to read from comma-separated files and populate vectors
    // [Implementation details omitted for brevity]
}
